# Check our guides at https://confluence.atlassian.com/x/14UWN for more examples.

# You can specify a custom docker image from Docker Hub as your build environment.
image: atlassianlabs/docker-node-jdk-chrome-firefox:latest

options:
  max-time: 5 # minutes

pipelines:
  default:
    - step:
        name: Prepare
        caches:
          - node
        script:
          - npm install
          - npx lerna bootstrap
          - npx lerna run clean
    - parallel:
        - step:
            name: Lint
            script:
              - npx lerna run lint:ci
        - step:
            name: Test
            caches:
              - node
            script:
              - npx lerna run test:ci
    - parallel:
        - step:
            name: Build Artifact
            script:
              - npx lerna run build:ci
        - step:
            name: Generate Documentation
            script:
              - npx lerna run docs
